<mat-toolbar>
    <button mat-icon-button *ngIf="sidenav.mode==='over'" (click)="sidenav.toggle()">
        <mat-icon *ngIf="!sidenav.opened">menu</mat-icon>
        <mat-icon *ngIf="sidenav.opened">close</mat-icon>
    </button>
    <p class="header">Biblioteka</p>
</mat-toolbar>

<mat-sidenav-container>
    <mat-sidenav style="width: auto;"  #sidenav="matSidenav">
        <img class="avatar mat-elevation-z8" [src]="picture" (click)="showProfile()">
        <h4 class="name">{{fullname}}</h4>
        <p class="designation">{{email}}</p>
        <mat-divider></mat-divider>


        <button mat-button class="menu-button" (click)="dodjiKuci();zaduzene=false;">
            <mat-icon>home</mat-icon>
            <span>Home page</span>
           </button>
       <button mat-button class="menu-button" (click)="menjajPass();zaduzene=false;">
        <mat-icon>password</mat-icon>
        <span>Change password</span>
       </button>
       <button mat-button class="menu-button" (click)="showSearch();zaduzene=false;">
        <mat-icon>search</mat-icon>
        <span>Search</span>
       </button>
       <button mat-button class="menu-button">
        <mat-icon>library_add</mat-icon>
        <span>Apply book</span>
       </button>
       <button mat-button class="menu-button" (click)="showZaduzene()">
        <mat-icon>library_books</mat-icon>
        <span>Books taken</span>
       </button>
       <button mat-button class="menu-button" (click)="showHistory();zaduzene=false;">
        <mat-icon>history</mat-icon>
        <span>History</span>
       </button>
       <button mat-button class="menu-button" (click)="odjava()">
        <mat-icon>logout</mat-icon>
        <span>Log out</span>
       </button>
    </mat-sidenav>
    <mat-sidenav-content>
        <div class="content mat-elevation-z4">
            <!-- <button (click)="showBook()">Show</button> -->
            <div *ngIf="showProf">
                <app-user-profile></app-user-profile>
            </div>


            <div *ngIf="showB">
            <h3>Knjiga dana</h3><hr>
            <img id="bookPict" [src]="book.picture"><hr>
            <div style="font-size: 1rem;">
            <label>Naziv knjige:</label>{{book.name}}<br>
            <label>Autori knjige:</label>{{writer}}<br>
            <label>Ocena:</label>{{ocena}}<br></div>

            <hr>
            <div>
                <label *ngIf="blokiran">Vas korisnicki nalog je blokiran</label>
            </div>
        </div>

        <div *ngIf="search">
            <h2 style="text-align: center;">Pretraga</h2>

            <div style="display: flex; align-items:center;justify-content: center; ">
              <span style="font-size: 1rem;"> Trazi na osnovu naziva knjige:</span> 
              <input type="text" name="search" style="margin: 2%;" [(ngModel)]="nameS">
              
            </div>
            
            
            <span style="font-size: 1rem;">Trazi na osnovu autora:</span> 
            <input type="text" style="margin: 0 2%;" name="search" [(ngModel)]="writerS">
            <br>
            <br>
            <button class="buttn" style="margin: 0;" (click)="searchByParam()">Trazi knjigu</button>

            <div *ngIf="showSearchBook" >
              <h3 style="margin: 5% 0; text-align: center;">Knjige</h3><hr>
              <div *ngFor="let b of bookSN" style="display: flex; flex-direction: column;justify-content: center; align-items: center; padding: 5% 0; border-bottom: solid black 1px;">
                <img id="bookPict" [src]="b.picture" (click)="skociNaKnjigu(b)"><hr>
                <div style="font-size: 1rem;">
                <label>Naziv knjige:</label>{{b.name}}<br>
                <label>Autori knjige:</label>{{b.writer}}<br>
                <label>Zanr:</label>{{b.style}}<br>
                <label>Izdavac:</label>{{b.publisher}}<br>
                <label>Godina izdanja:</label>{{b.year}}<br>
                <label>Jezik:</label>{{b.language}}<br>
              </div>    
              </div>  
                
            </div>

        </div>
        <div *ngIf="bookPageShow"><app-book-page></app-book-page></div>
        <div *ngIf="history" style="overflow-x: scroll;">
           
            
           
            
            <table class="tab-his" style="font-size:1rem;">
                <tr>
                    <th style="padding: 10px; margin: 0"> <button class="buttn"  (click)="sortName()">Sortiraj po nazivu</button></th>
                    <th style="padding: 10px; margin: 0"><button class="buttn"  (click)="sortWrite()">Sortiraj po autoru</button></th>
                    <th  style="padding: 10px; margin: 0"> <button class="buttn" (click)="sortStart()">Sortiraj po datumu zaduzivanja</button></th>
                    <th style="padding: 10px; margin: 0"><button class="buttn"  (click)="showHistory()">Sortiraj po datumu vracanja</button></th>
                    <th></th>
                </tr>
                <tr>
                    <th>Naziv knjige</th>
                    <th>Autori knjige:</th>
                    <th>Datum zaduzivanja</th>
                    <th>Datum vracanja</th>
                    <th>Akcija</th>
                </tr>
                <br>
                <tr *ngFor="let j of joinBooks" >
                    <td>{{j.name}}</td>
                    <td>{{j.writer}}</td>
                    <td>{{j.startDate}}</td>
                    <td>{{j.endDate}}</td>
                    <td><button (click)="vodi(j._id)">Poseti stranicu</button></td>
                </tr>
            </table>
        </div>
        <div *ngIf="menjaj"><app-change-pass></app-change-pass></div>
        
        <div *ngIf="zaduzene">
            
               
            <div fxLayout='row' fxLayoutWrap class="cards" style="display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 5%;">

      
            <mat-card class="example-card" *ngFor="let m of joinBooks">
                <mat-card-header>
                <mat-card-title>{{m.name}}</mat-card-title>
                <mat-card-subtitle>{{m.writer}}</mat-card-subtitle>
                </mat-card-header>
                <img mat-card-md-image id="picCard" [src]="m.picture" alt="Photo of a {m.name}">
                <mat-card-content>
                <p [ngClass]="{'colorError': zakasnio(m.jos)}"> 
                    Preostalo dana:{{m.jos}}
                </p>
                </mat-card-content>
                <mat-card-actions>
                <button mat-button (click)="vrati(m._id)">Vrati</button>
                <button mat-button (click)="produzi(m._id,m.jos, m.extended)">Produzi</button>
                </mat-card-actions>
            </mat-card>
            
            </div>
           
        
        </div>
    </div>
    </mat-sidenav-content>
</mat-sidenav-container>